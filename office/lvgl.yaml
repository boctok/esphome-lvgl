# lvgl.yaml (Nur die Ergänzungen/Änderungen, der Rest deiner lvgl.yaml bleibt!)
lvgl:
  top_layer:
    widgets:
      # ... (deine bestehenden top_layer Widgets: temperatures, display_time, wifi_icon_label, page_footer) ...
      - obj: # NEU: Dimmer MsgBox
          id: stehlampe_dimmer_msgbox
          width: 300
          height: 200
          align: center
          hidden: true
          bg_color: 0x222222
          border_width: 2
          border_color: 0x888888
          radius: 10
          layout:
            type: flex
            flex_flow: column
            flex_align_main: space_evenly
            flex_align_cross: center
          widgets:
            - label:
                id: stehlampe_dimmer_label
                text: "Stehlampe Helligkeit"
                text_font: $text_font # Stelle sicher, dass $text_font hier verfügbar ist
                pad_top: 10
            - slider:
                id: stehlampe_brightness_slider
                width: 80%
                height: 30
                min_value: 1
                max_value: 255
                value: 128 # Initialwert
                on_value_set:
                  - homeassistant.service: # Direkt den HA Service aufrufen
                      service: light.turn_on
                      data:
                        entity_id: light.wohnzimmer_stehlampe
                        brightness: !lambda 'return x;'
            - button:
                id: stehlampe_dimmer_close_button
                width: 100
                margin_top: 10
                margin_bottom: 10
                widgets:
                  - label:
                      text: "OK"
                      text_font: $text_font # Stelle sicher, dass $text_font hier verfügbar ist
                on_click:
                  - lvgl.widget.hide: stehlampe_dimmer_msgbox
                  - lambda: |-
                      id(dimmer_msgbox_active) = false;
  pages:
    # ... (deine bestehende weather_page) ...
    - id: main_page
      # ... (Layout und andere Widgets deiner main_page bleiben unverändert) ...
      widgets:
        # ... (dein wz_lichtschalter_button und andere Buttons bleiben unverändert) ...
        - button: # Dies ist dein wohnzimmer_stehlampe_button
            grid_cell_column_pos: 1 # Beispielposition, nimm deine
            grid_cell_row_pos: 0    # Beispielposition, nimm deine
            id: wohnzimmer_stehlampe_button
            height: 100px
            checkable: true
            styles: control
            widgets:
              - label:
                  text_font: $icon_font
                  align: top_left
                  id: wohnzimmer_stehlampe_icon # Deine bestehende ID
                  text: $lightbulb_off # Wird von deinem binary_sensor gesteuert
              - label:
                  text_font: $text_font
                  align: bottom_left
                  id: wohnzimmer_stehlampe_label # Deine bestehende ID
                  text: "Stehlampe"
            on_click:
              - homeassistant.service:
                  service: light.toggle
                  data:
                    entity_id: light.wohnzimmer_stehlampe
            on_long_press: # HINZUGEFÜGT
              - lambda: |-
                  id(dimmer_msgbox_active) = true;
                  if (id(wohnzimmer_stehlampe_brightness_sensor).has_state()) {
                    lv_slider_set_value(id(stehlampe_brightness_slider).get_obj(), id(wohnzimmer_stehlampe_brightness_sensor).state, LV_ANIM_OFF);
                  } else {
                    lv_slider_set_value(id(stehlampe_brightness_slider).get_obj(), 128, LV_ANIM_OFF); // Fallback, falls kein Zustand
                  }
              - lvgl.widget.show: stehlampe_dimmer_msgbox
        # ... (Rest deiner main_page Widgets bleiben unverändert) ...
