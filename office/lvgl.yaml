lvgl:
  top_layer:
    widgets:
      - label:
          id: wifi_icon_label
          text: "\U000F092E" # Initial: mdi-wifi-strength-off-outline
          styles: roboto15_style
          text_font: $icon_font_header
          align: top_right
          x: -8
          y: 4
          text_color: 0xFFFFFF

      - label:
          id: header_temperatures
          text: "-°/-°"
          styles: roboto15_style
          align: top_left
          x: 8
          y: 4
          text_color: 0xFFFFFF
          hidden: !lambda |- # Nur auf Button-Seite sichtbar
            return lv_scr_act() != lv_page_get_obj_by_id(lv_page_get_id_by_name("main_buttons_page"));

      - label:
          id: header_display_time
          text: "--:--"
          styles: roboto15_style
          align: top_mid
          x: 0
          y: 4
          text_align: center
          text_color: 0xFFFFFF
          hidden: !lambda |- # Nur auf Button-Seite sichtbar
            return lv_scr_act() != lv_page_get_obj_by_id(lv_page_get_id_by_name("main_buttons_page"));

      - obj:
          id: page_footer
          align: bottom_mid
          width: 100%
          height: 24px
          bg_opa: 0
          border_width: 0
          pad_all: 2px
          layout:
            type: flex
            flex_flow: row
            flex_align_main: space_between
            flex_align_cross: center
          widgets:
            - button:
                id: footer_prev_button
                styles: footer_button_style
                width: 60px
                height: 20px
                radius: $radius
                bg_opa: 0
                border_width: 0
                widgets:
                  - label:
                      text_font: $icon_font_header
                      text_color: $button_text_color
                      text: $arrow_left
                      align: center
                on_click:
                  - lvgl.page.previous:
                      animation: MOVE_LEFT
                      time: 300ms
            - button:
                id: footer_home_button
                styles: footer_button_style
                width: 60px
                height: 20px
                radius: $radius
                bg_opa: 0
                border_width: 0
                widgets:
                  - label:
                      text_font: $icon_font_header
                      text_color: $button_text_color
                      text: $home
                      align: center
                on_click:
                  - lvgl.page.show: weather_page
            - button:
                id: footer_next_button
                styles: footer_button_style
                width: 60px
                height: 20px
                radius: $radius
                bg_opa: 0
                border_width: 0
                widgets:
                  - label:
                      text_font: $icon_font_header
                      text_color: $button_text_color
                      text: $arrow_right
                      align: center
                on_click:
                  - lvgl.page.next:
                      animation: MOVE_RIGHT
                      time: 300ms
  pages:
    - id: weather_page
      bg_image_src: weather_page_background
      bg_opa: cover
      pad_all: 15px
      layout:
        type: grid
        grid_columns: [FR(45), FR(55)] 
        grid_rows: [FR(20), FR(55), FR(25)]
      widgets:
        - label:
            id: time_date_label
            text: "Lade Zeit..."
            text_font: $font_time_date
            text_color: 0xFFFFFF
            text_align: center
            grid_cell_column_pos: 0
            grid_cell_row_pos: 0
            grid_cell_column_span: 2
            grid_cell_y_align: center

        - label:
            id: weather_main_icon
            text: "\U000F0599" # Initial: Sunny
            text_font: $font_weather_main_icon
            text_color: 0xFFFFFF
            grid_cell_column_pos: 0
            grid_cell_row_pos: 1
            grid_cell_x_align: center
            grid_cell_y_align: center
        
        - label:
            id: weather_condition_label
            text: "Wetter lädt..."
            text_font: $font_weather_text
            text_color: 0xFFFFFF
            text_align: left
            long_mode: LV_LABEL_LONG_WRAP # Korrigiert
            grid_cell_column_pos: 1
            grid_cell_row_pos: 1
            grid_cell_x_align: start
            grid_cell_y_align: center
            pad_left: 10px

        - obj:
            grid_cell_column_pos: 0
            grid_cell_row_pos: 2
            grid_cell_column_span: 2
            width: 100%
            height: SIZE_CONTENT
            bg_opa: transparent
            layout:
              type: flex
              flex_flow: row
              flex_main_place: space_around
              flex_cross_place: center
            widgets:
              - obj:
                  width: SIZE_CONTENT
                  height: SIZE_CONTENT
                  bg_opa: transparent
                  layout: { type: flex, flex_flow: row, flex_cross_place: center }
                  widgets:
                    - label:
                        id: indoor_temp_icon_label
                        text: $temp_indoor_icon
                        text_font: $icon_font_header
                        text_color: 0xFFFFFF
                        pad_right: 8px
                    - label:
                        id: indoor_temp_value_label
                        text: "--.-°C"
                        text_font: $font_weather_text
                        text_color: 0xFFFFFF
              - obj:
                  width: SIZE_CONTENT
                  height: SIZE_CONTENT
                  bg_opa: transparent
                  layout: { type: flex, flex_flow: row, flex_cross_place: center }
                  widgets:
                    - label:
                        id: outdoor_temp_icon_label
                        text: $temp_outdoor_icon
                        text_font: $icon_font_header
                        text_color: 0xFFFFFF
                        pad_right: 8px
                    - label:
                        id: outdoor_temp_value_label
                        text: "--.-°C"
                        text_font: $font_weather_text
                        text_color: 0xFFFFFF

    - id: main_buttons_page # Deine ursprüngliche main_page, jetzt zweite Seite
      width: 100%
      bg_color: 0x000000 # Schwarz
      bg_opa: cover
      pad_top: 30px
      pad_bottom: 26px
      pad_left: 5px
      pad_right: 5px
      layout:
        type: grid
        grid_columns: [FR(1), FR(1), FR(1), FR(1), FR(1)]
        grid_rows: [CONTENT, CONTENT, CONTENT, CONTENT]
      widgets:
        - button: 
            grid_cell_column_pos: 0
            grid_cell_row_pos: 0
            height: $button_height_single
            checkable: false
            id: office_scene_features_button
            styles: control
            widgets:
              - label: {text_font: $icon_font, align: top_left, id: scene_features_icon, text: $ledstrip}
              - label: {align: bottom_left, id: scene_features_label, text: "Features"}
            on_press: [{homeassistant.service: {service: scene.turn_on, data: {entity_id: scene.office_features}}}]
        - button: 
            grid_cell_column_pos: 1
            grid_cell_row_pos: 0
            height: $button_height_single
            checkable: false
            id: office_scene_calls_button
            styles: control
            widgets:
              - label: {text_font: $icon_font, align: top_left, id: office_scene_calls_icon, text: $videocall}
              - label: {align: bottom_left, id: office_scene_calls_label, text: "Calls"}
            on_press: [{homeassistant.service: {service: scene.turn_on, data: {entity_id: scene.office_desk_call}}}]
        - button: 
            grid_cell_column_pos: 2
            grid_cell_row_pos: 0
            height: $button_height_single
            checkable: false
            id: office_scene_evening_button
            styles: control
            widgets:
              - label: {text_font: $icon_font, align: top_left, id: office_scene_evening_icon, text: $nightlight}
              - label: {align: bottom_left, id: office_scene_evening_label, text: "Evening"}
            on_press: [{homeassistant.service: {service: scene.turn_on, data: {entity_id: scene.office_evening}}}]
        - button: 
            grid_cell_column_pos: 3
            grid_cell_row_pos: 0
            height: $button_height_single
            checkable: false
            id: office_scene_dimmed_button
            styles: control
            widgets:
              - label: {text_font: $icon_font, align: top_left, id: office_scene_dimmed_icon, text: $nightlight}
              - label: {align: bottom_left, id: office_scene_dimmed_label, text: "Dimmed"}
            on_press: [{homeassistant.service: {service: scene.turn_on, data: {entity_id: scene.office_dimmed}}}]
        - button: 
            grid_cell_column_pos: 4
            grid_cell_row_pos: 0
            height: $button_height_single
            checkable: true
            id: printer_power_button
            styles: control
            widgets:
              - label: {text_font: $icon_font, align: top_left, id: printer_power_icon, text: $printer}
              - label: {align: bottom_left, id: printer_power_label, text: "Printer"}
            on_click: [{homeassistant.service: {service: switch.toggle, data: {entity_id: switch.office_3d_printer_power}}}]
        - button: 
            grid_cell_column_pos: 0
            grid_cell_row_pos: 1
            height: $button_height_single
            checkable: true
            id: wz_button
            styles: control
            widgets:
              - label: {text_font: $icon_font, align: top_left, text: $lightbulb}
              - label: {align: bottom_left, text: "Wohnzimmer"}
            on_click: [{homeassistant.service: {service: switch.toggle, data: {entity_id: light.wz_lichtschalter}}}]
        - button: 
            grid_cell_column_pos: 1
            grid_cell_row_pos: 1
            height: $button_height_single
            checkable: true
            id: office_blind_open_button
            styles: control
            widgets:
              - label: {text_font: $icon_font, align: top_left, text: $blinds_open}
              - label: {align: bottom_left, text: "Open"}
            on_click: [{homeassistant.service: {service: cover.set_cover_position, data: {entity_id: cover.wohnzimmer_rechts, position: "78"}}}]
        - button: 
            grid_cell_column_pos: 2
            grid_cell_row_pos: 1
            height: $button_height_single
            checkable: true
            id: office_blind_close_button
            styles: control
            widgets:
              - label: {text_font: $icon_font, align: top_left, text: $blinds_closed}
              - label: {align: bottom_left, text: "Close"}
            on_click: [{homeassistant.service: {service: cover.set_cover_position, data: {entity_id: cover.wohnzimmer_rechts, position: "0"}}}]
        - button: 
            grid_cell_column_pos: 3
            grid_cell_row_pos: 1
            height: $button_height_single
            checkable: false
            id: webhook_mail_button
            styles: webhook
            widgets:
              - label: {text_font: $icon_font, align: top_left, text: $gmail}
              - label: {align: bottom_left, text: "Mail"}
            on_click: [{homeassistant.service: {service: button.press, data: {entity_id: button.webhook_mail}}}]
        - button: 
            grid_cell_column_pos: 4
            grid_cell_row_pos: 1
            height: $button_height_single
            checkable: false
            id: webhook_slack_button
            styles: webhook
            widgets:
              - label: {text_font: $icon_font, align: top_left, text: $slack}
              - label: {align: bottom_left, text: "Slack"}
            on_click: [{homeassistant.service: {service: button.press, data: {entity_id: button.webhook_slack}}}]
        - button: 
            grid_cell_column_pos: 0
            grid_cell_row_pos: 2
            height: $button_height_single
            checkable: false
            id: webhook_meet_button
            styles: webhook
            widgets:
              - image: {src: meet_logo, antialias: true}
              - label: {align: bottom_left, text: "Meet"}
            on_click: [{homeassistant.service: {service: button.press, data: {entity_id: button.webhook_meet}}}]
        - button:
