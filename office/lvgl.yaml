# lvgl.yaml
lvgl:
  top_layer:
    widgets:
      - label:
          text: -° / -°
          id: temperatures
          styles: roboto15_style
          align: top_left
          x: 8
          y: 4
          text_color: 16777215
      - label:
          text: --:--
          id: display_time
          styles: roboto15_style
          align: top_mid
          x: 0
          y: 4
          text_align: center
          text_color: 16777215
      - label:
          text: ""
          id: wifi_icon_label
          styles: roboto15_style
          text_font: icon_font_header
          align: top_right
          x: -8
          y: 4
          text_color: 16777215
      - obj:
          id: page_footer
          align: bottom_mid
          width: 100%
          height: 24px
          bg_color: $button_control_color
          border_width: 0
          pad_all: 2px
          layout:
            type: flex
            flex_flow: row
            flex_align_main: space_between
            flex_align_cross: center
          widgets:
            - button:
                id: footer_prev_button
                styles: footer_button_style
                width: 60px
                height: 20px
                radius: 12px
                bg_color: $button_control_color
                border_width: 0
                widgets:
                  - label:
                      text_font: icon_font_header
                      text_color: 16777215
                      text: "\U000F0731"
                      align: center
                on_click:
                  - lvgl.page.previous:
                      animation: MOVE_RIGHT
                      time: 300ms
            - button:
                id: footer_home_button
                styles: footer_button_style
                width: 60px
                height: 20px
                radius: 12px
                bg_color: $button_control_color
                border_width: 0
                widgets:
                  - label:
                      text_font: icon_font_header
                      text_color: 16777215
                      text: "\U000F02DC"
                      align: center
                on_click:
                  - lvgl.page.show: weather_page
            - button:
                id: footer_next_button
                styles: footer_button_style
                width: 60px
                height: 20px
                radius: 12px
                bg_color: $button_control_color
                border_width: 0
                widgets:
                  - label:
                      text_font: icon_font_header
                      text_color: 16777215
                      text: "\U000F0734"
                      align: center
                on_click:
                  - lvgl.page.next:
                      animation: MOVE_LEFT
                      time: 300ms
  pages:
    - id: weather_page
      width: 100%
      bg_color: 0
      bg_opa: cover
      pad_top: 30px
      pad_bottom: 26px
      pad_left: 5px
      pad_right: 5px
      widgets:
        - label:
            id: weekday_label
            align: top_right
            x: -33
            y: 10
            width: 350
            text_align: right
            text_font: roboto36_font
            text_color: 16777215
            text: !lambda |-
              static const char* weekdays[] = {"Sonntag", "Montag", "Dienstag", "Mittwoch", "Donnerstag", "Freitag", "Samstag"};
              auto now = id(sntp_time).now();
              if (now.is_valid()) {
                return weekdays[now.day_of_week - 1];
              } else {
                return "Unbekannt";
              }
        - label:
            id: date_label
            align: top_right
            x: -33
            y: 50
            width: 350
            text_align: right
            text_font: roboto36_font
            text_color: 16777215
            text: !lambda |-
              static const char* months[] = {"Jan", "Feb", "Mär", "Apr", "Mai", "Jun", "Jul", "Aug", "Sep", "Okt", "Nov", "Dez"};
              auto now = id(sntp_time).now();
              if (now.is_valid()) {
                char date_buf[30];
                snprintf(date_buf, sizeof(date_buf), "%02d. %s %d", now.day_of_month, months[now.month - 1], now.year);
                return std::string(date_buf);
              } else {
                return "--.--.----";
              }
        - label:
            id: time_label
            align: top_right
            x: -33
            y: 90
            width: 350
            text_align: right
            text_font: roboto36_font
            text_color: 16777215
            text: !lambda |-
              static char time_buf[6];
              auto now = id(sntp_time).now();
              if (now.is_valid()) {
                snprintf(time_buf, sizeof(time_buf), "%02d:%02d", now.hour, now.minute);
                return time_buf;
              } else {
                return "--:--";
              }
        - label:
            id: outdoor_temp_large_label
            x: 28
            y: 10
            text_font: roboto36_font
            text_color: 16777215
            text: !lambda |-
              char temp_buf[20];
              float temp_val = id(aussen_temp_wert);
              if (isnan(temp_val)) {
                return std::string("--,-° C");
              }
              snprintf(temp_buf, sizeof(temp_buf), "%.1f° C", temp_val);
              for (int i = 0; temp_buf[i] != '\0'; i++) {
                  if (temp_buf[i] == '.') {
                      temp_buf[i] = ',';
                      break;
                  }
              }
              return std::string(temp_buf);
        - image:
            id: lvgl_weather_image_widget
            x: 28
            y: 55
            width: 100
            height: 100
            src: icon_png_sunny
        - label:
            id: weather_description
            x: 138
            y: 87
            text_font: roboto36_font
            text_color: 16777215
            text: !lambda |-
              return id(esphome_weather_forecast_home).state;
    - id: main_page
      width: 100%
      bg_color: 0
      bg_opa: cover
      pad_top: 30px
      pad_bottom: 26px
      pad_left: 5px
      pad_right: 5px
      layout:
        type: grid
        grid_columns: [FR(1), FR(1), FR(1), FR(1), FR(1)]
        grid_rows: [CONTENT, CONTENT, CONTENT, CONTENT]
      widgets:
        - button:
            grid_cell_column_pos: 0
            grid_cell_row_pos: 0
            height: $button_height_double # Dieser Button überspannt zwei Zeilen
            grid_cell_row_span: 2      # Explizit angeben
            checkable: false
            id: office_scene_features_button
            styles: control
            widgets:
              - label:
                  text_font: $icon_font # Verwende Substitution
                  align: top_left
                  id: scene_features_icon
                  text: "\U000F1051"
              - label:
                  text_font: $text_font # Explizit die Text-Schriftart zuweisen
                  align: bottom_left
                  id: scene_features_label
                  text: "Features"
            on_press:
              - homeassistant.service:
                  service: scene.turn_on
                  data:
                    entity_id: scene.office_features
        - button:
            grid_cell_column_pos: 1
            grid_cell_row_pos: 0
            height: 100px
            checkable: false
            id: office_scene_calls_button
            styles: control
            widgets:
              - label:
                  text_font: $icon_font # Verwende Substitution
                  align: top_left
                  id: office_scene_calls_icon
                  text: "\U000F036B"
              - label:
                  text_font: $text_font # Explizit die Text-Schriftart zuweisen
                  align: bottom_left
                  id: office_scene_calls_label
                  text: "Calls"
            on_press:
              - homeassistant.service:
                  service: scene.turn_on
                  data:
                    entity_id: scene.office_desk_call
        - button:
            grid_cell_column_pos: 2
            grid_cell_row_pos: 0
            height: 100px
            checkable: false
            id: office_scene_evening_button
            styles: control
            widgets:
              - label:
                  text_font: $icon_font # Verwende Substitution
                  align: top_left
                  id: office_scene_evening_icon
                  text: "\U000F1A4C"
              - label:
                  text_font: $text_font # Explizit die Text-Schriftart zuweisen
                  align: bottom_left
                  id: office_scene_evening_label
                  text: "Evening"
            on_press:
              - homeassistant.service:
                  service: scene.turn_on
                  data:
                    entity_id: scene.office_evening
        # ... (Rest der Buttons analog anpassen: Icon-Labels mit text_font: $icon_font, Text-Labels mit text_font: $text_font)
        # Beispiel für einen Button in der "leeren" Zelle neben dem hohen Button:
        - button:
            grid_cell_column_pos: 1 # Nächste Spalte
            grid_cell_row_pos: 1    # Zweite Zeile (neben dem hohen Button)
            height: 100px           # Standardhöhe
            id: wz_button           # ID deines WZ-Buttons (oder ein anderer)
            styles: control
            widgets:
              - label:
                  text_font: $icon_font
                  align: top_left
                  text: "\U000F0335" # Lightbulb
              - label:
                  text_font: $text_font
                  align: bottom_left
                  text: "Wohnzimmer"
            on_click:
              - homeassistant.service:
                  service: switch.toggle
                  data:
                    entity_id: light.wz_lichtschalter

        # Alle weiteren Buttons müssen ihre grid_cell_row_pos und grid_cell_column_pos
        # entsprechend der neuen Anordnung bekommen.
        # Du musst die Positionen manuell durchgehen und anpassen,
        # um die Lücken zu füllen und das 5x4 Grid nicht zu überschreiten.

        # Beispiel: Der "Dimmed" Button, der vorher in Spalte 3, Zeile 0 war,
        # könnte jetzt in Spalte 3, Zeile 0 bleiben, oder wenn du die Lücke füllen willst,
        # und der WZ-Button jetzt in Spalte 1, Zeile 1 ist, könnte
        # der "Open Blinds" Button (vorher Spalte 1, Zeile 1) jetzt z.B. in Spalte 2, Zeile 1 etc.

        # HIER MUSST DU DIE VERBLEIBENDEN BUTTONS MANUELL NEU ANORDNEN
        # Es ist wichtig, dass keine grid_cell_column_pos >= 5 wird
        # und keine grid_cell_row_pos >= 4 (für ein 5x4 Grid).

        # Hier sind die restlichen Buttons aus deiner lvgl.yaml, du musst grid_cell_column_pos und grid_cell_row_pos
        # so anpassen, dass sie die Lücken füllen und im Raster bleiben.
        # Ich lasse die ursprünglichen Positionen als Kommentar stehen und du musst sie anpassen.

        - button: # Ursprünglich Spalte 3, Zeile 0
            # grid_cell_column_pos: 3 # Anpassen!
            # grid_cell_row_pos: 0    # Anpassen!
            height: 100px
            checkable: false
            id: office_scene_dimmed_button
            styles: control
            widgets:
              - label:
                  text_font: $icon_font
                  align: top_left
                  id: office_scene_dimmed_icon
                  text: "\U000F1A4C"
              - label:
                  text_font: $text_font
                  align: bottom_left
                  id: office_scene_dimmed_label
                  text: "Dimmed"
            on_press:
              - homeassistant.service:
                  service: scene.turn_on
                  data:
                    entity_id: scene.office_dimmed

        - button: # Ursprünglich Spalte 4, Zeile 0
            # grid_cell_column_pos: 4 # Anpassen!
            # grid_cell_row_pos: 0    # Anpassen!
            height: 100px
            checkable: true
            id: printer_power_button
            styles: control
            widgets:
              - label:
                  text_font: $icon_font
                  align: top_left
                  id: printer_power_icon
                  text: "\U000F042B"
              - label:
                  text_font: $text_font
                  align: bottom_left
                  id: printer_power_label
                  text: "Printer"
            on_click:
              - homeassistant.service:
                  service: switch.toggle
                  data:
                    entity_id: switch.office_3d_printer_power

        # Der WZ-Button wurde oben als Beispiel verschoben (Spalte 1, Zeile 1)
        # Wenn du ihn dort lässt, dann weiter mit den nächsten:

        - button: # Ursprünglich Spalte 1, Zeile 1 (jetzt ggf. woanders)
            # grid_cell_column_pos: 2 # Anpassen!
            # grid_cell_row_pos: 1    # Anpassen!
            height: 100px
            checkable: true
            id: office_blind_open_button
            styles: control
            widgets:
              - label:
                  text_font: $icon_font
                  align: top_left
                  text: "\U000F1011"
              - label:
                  text_font: $text_font
                  align: bottom_left
                  text: "Open"
            on_click:
              - homeassistant.service:
                  service: cover.set_cover_position
                  data:
                    entity_id: cover.wohnzimmer_rechts
                    position: "78"

        - button: # Ursprünglich Spalte 2, Zeile 1
            # grid_cell_column_pos: 3 # Anpassen!
            # grid_cell_row_pos: 1    # Anpassen!
            height: 100px
            checkable: true
            id: office_blind_close_button
            styles: control
            widgets:
              - label:
                  text_font: $icon_font
                  align: top_left
                  text: "\U000F00AC"
              - label:
                  text_font: $text_font
                  align: bottom_left
                  text: "Close"
            on_click:
              - homeassistant.service:
                  service: cover.set_cover_position
                  data:
                    entity_id: cover.wohnzimmer_rechts
                    position: "0"

        - button: # Ursprünglich Spalte 3, Zeile 1
            # grid_cell_column_pos: 4 # Anpassen!
            # grid_cell_row_pos: 1    # Anpassen!
            height: 100px
            checkable: false
            id: webhook_mail_button
            styles: webhook
            widgets:
              - label:
                  text_font: $icon_font
                  align: top_left
                  text: "\U000F02AB"
              - label:
                  text_font: $text_font
                  align: bottom_left
                  text: "Mail"
            on_click:
              - homeassistant.service:
                  service: button.press
                  data:
                    entity_id: button.webhook_mail

        - button: # Ursprünglich Spalte 4, Zeile 1 -> wird dann zu Spalte 0, Zeile 2
            grid_cell_column_pos: 0 # Beispiel: Nächste Zeile, erste Spalte
            grid_cell_row_pos: 2
            height: 100px
            checkable: false
            id: webhook_slack_button
            styles: webhook
            widgets:
              - label:
                  text_font: $icon_font
                  align: top_left
                  text: "\U000F04B1"
              - label:
                  text_font: $text_font
                  align: bottom_left
                  text: "Slack"
            on_click:
              - homeassistant.service:
                  service: button.press
                  data:
                    entity_id: button.webhook_slack

        # Die image-basierten Buttons (Meet, Figma, Mainsail)
        - button: # Ursprünglich Spalte 0, Zeile 2
            grid_cell_column_pos: 1 # Beispiel
            grid_cell_row_pos: 2
            height: 100px
            checkable: false
            id: webhook_meet_button
            styles: webhook
            widgets:
              - image:
                  src: meet_logo
                  antialias: true
              - label:
                  text_font: $text_font
                  align: bottom_left
                  text: "Meet"
            on_click:
              - homeassistant.service:
                  service: button.press
                  data:
                    entity_id: button.webhook_meet

        - button: # Ursprünglich Spalte 1, Zeile 2
            grid_cell_column_pos: 2 # Beispiel
            grid_cell_row_pos: 2
            height: 100px
            checkable: false
            id: webhook_figma_button
            styles: webhook
            widgets:
              - image:
                  src: figma_logo
                  antialias: true
              - label:
                  text_font: $text_font
                  align: bottom_left
                  text: "Figma"
            on_click:
              - homeassistant.service:
                  service: button.press
                  data:
                    entity_id: button.webhook_figma

        - button: # Ursprünglich Spalte 2, Zeile 2
            grid_cell_column_pos: 3 # Beispiel
            grid_cell_row_pos: 2
            height: 100px
            checkable: false
            id: webhook_forklift_button
            styles: webhook
            widgets:
              - label:
                  text_font: $icon_font
                  align: top_left
                  text: "\U000F07C9"
              - label:
                  text_font: $text_font
                  align: bottom_left
                  text: "Forklift"
            on_click:
              - homeassistant.service:
                  service: button.press
                  data:
                    entity_id: button.webhook_forklift

        - button: # Ursprünglich Spalte 3, Zeile 2
            grid_cell_column_pos: 4 # Beispiel
            grid_cell_row_pos: 2
            height: 100px
            checkable: false
            id: webhook_iawriter_button
            styles: webhook
            widgets:
              - label:
                  text_font: $icon_font
                  align: top_left
                  text: "\U000F0633"
              - label:
                  text_font: $text_font
                  align: bottom_left
                  text: "Ia Writer"
            on_click:
              - homeassistant.service:
                  service: button.press
                  data:
                    entity_id: button.webhook_iawriter

        - button: # Ursprünglich Spalte 4, Zeile 2 -> wird dann zu Spalte 0, Zeile 3
            grid_cell_column_pos: 0 # Beispiel
            grid_cell_row_pos: 3
            height: 100px
            checkable: false
            id: webhook_mainsail_button
            styles: webhook
            widgets:
              - image:
                  src: mainsail_logo
                  antialias: true
              - label:
                  text_font: $text_font
                  align: bottom_left
                  text: "Mainsail"
            on_click:
              - homeassistant.service:
                  service: button.press
                  data:
                    entity_id: button.webhook_mainsail

        - button: # Ursprünglich Spalte 0, Zeile 3
            grid_cell_column_pos: 1 # Beispiel
            grid_cell_row_pos: 3
            id: wohnzimmer_stehlampe_button
            height: 100px
            checkable: true
            styles: control
            widgets:
              - label:
                  text_font: $icon_font
                  align: top_left
                  id: wohnzimmer_stehlampe_icon
                  text: "\U000F0336"
              - label:
                  text_font: $text_font
                  align: bottom_left
                  id: wohnzimmer_stehlampe_label
                  text: "Wohnzimmer Stehlampe"
            on_click:
              - homeassistant.service:
                  service: light.toggle
                  data:
                    entity_id: light.wohnzimmer_stehlampe
